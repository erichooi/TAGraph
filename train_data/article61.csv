,Text,Label
0,Recently,O
1,",",O
2,the,O
3,Advanced,O
4,Threat,O
5,Response,O
6,Team,O
7,of,O
8,360,O
9,Core,O
10,Security,O
11,Division,O
12,detected,O
13,an,O
14,APT,O
15,attack,O
16,exploiting,O
17,a,O
18,0,O
19,-,O
20,day,O
21,vulnerability,O
22,tracked,O
23,as,O
24,CVE,O
25,-,O
26,2018,O
27,-,O
28,8174,O
29,.,O
30,Now,O
31,the,O
32,experts,O
33,published,O
34,a,O
35,detailed,O
36,analysis,O
37,of,O
38,the,O
39,flaw,O
40,.,O
41,I,O
42,Overview,O
43,Recently,O
44,",",O
45,the,O
46,Advanced,O
47,Threat,O
48,Response,O
49,Team,O
50,of,O
51,360,O
52,Core,O
53,Security,O
54,Division,O
55,detected,O
56,an,O
57,APT,O
58,attack,O
59,exploiting,O
60,a,O
61,0,O
62,-,O
63,day,O
64,vulnerability,O
65,and,O
66,captured,O
67,the,O
68,world,O
69,’,O
70,s,O
71,first,O
72,malicious,O
73,sample,O
74,that,O
75,uses,O
76,a,O
77,browser,O
78,0,O
79,-,O
80,day,O
81,vulnerability,O
82,.,O
83,We,O
84,codenamed,O
85,the,O
86,vulnerability,O
87,as,O
88,“,O
89,double,O
90,kill,O
91,”,O
92,exploit,O
93,.,O
94,This,O
95,vulnerability,O
96,affects,O
97,the,O
98,latest,O
99,version,O
100,of,O
101,Internet,O
102,Explorer,O
103,and,O
104,applications,O
105,that,O
106,use,O
107,the,O
108,IE,O
109,kernel,O
110,.,O
111,When,O
112,users,O
113,browse,O
114,the,O
115,web,O
116,or,O
117,open,O
118,Office,O
119,documents,O
120,",",O
121,they,O
122,are,O
123,likely,O
124,to,O
125,be,O
126,potential,O
127,targets,O
128,.,O
129,Eventually,O
130,the,O
131,hackers,O
132,will,O
133,implant,O
134,backdoor,O
135,Trojan,O
136,to,O
137,completely,O
138,control,O
139,the,O
140,computer,O
141,.,O
142,In,O
143,response,O
144,",",O
145,we,O
146,shared,O
147,with,O
148,Microsoft,O
149,the,O
150,relevant,O
151,details,O
152,of,O
153,the,O
154,0day,O
155,vulnerability,O
156,in,O
157,a,O
158,timely,O
159,manner,O
160,.,O
161,This,O
162,APT,O
163,attack,O
164,was,O
165,analyzed,O
166,and,O
167,attributed,O
168,upon,O
169,the,O
170,detection,O
171,and,O
172,we,O
173,now,O
174,confirmed,O
175,its,O
176,association,O
177,with,O
178,the,O
179,APT,B-Actor
180,-,I-Actor
181,C,I-Actor
182,-,I-Actor
183,06,I-Actor
184,Group,I-Actor
185,.,O
186,On,O
187,April,O
188,18,O
189,",",O
190,2018,O
191,",",O
192,as,O
193,soon,O
194,as,O
195,360,O
196,Core,O
197,Security,O
198,detected,O
199,the,O
200,malicious,O
201,activity,O
202,",",O
203,we,O
204,contacted,O
205,Microsoft,O
206,without,O
207,any,O
208,delay,O
209,and,O
210,submitted,O
211,relevant,O
212,details,O
213,to,O
214,Microsoft,O
215,.,O
216,Microsoft,O
217,confirmed,O
218,this,O
219,vulnerability,O
220,on,O
221,the,O
222,morning,O
223,of,O
224,April,O
225,20th,O
226,and,O
227,released,O
228,an,O
229,official,O
230,security,O
231,patch,O
232,on,O
233,May,O
234,8th,O
235,.,O
236,Microsoft,O
237,has,O
238,fixed,O
239,the,O
240,vulnerability,O
241,and,O
242,named,O
243,it,O
244,CVE,O
245,-,O
246,2018,O
247,-,O
248,8174,O
249,.,O
250,After,O
251,the,O
252,vulnerability,O
253,was,O
254,properly,O
255,resolved,O
256,",",O
257,we,O
258,published,O
259,this,O
260,report,O
261,on,O
262,May,O
263,9th,O
264,",",O
265,along,O
266,with,O
267,further,O
268,technical,O
269,disclosure,O
270,of,O
271,the,O
272,attack,O
273,and,O
274,the,O
275,0day,O
276,.,O
277,II,O
278,Affection,O
279,in,O
280,China,O
281,According,O
282,to,O
283,the,O
284,sample,O
285,data,O
286,analysis,O
287,",",O
288,the,O
289,attack,O
290,affected,O
291,regions,O
292,in,O
293,China,O
294,are,O
295,mainly,O
296,distributed,O
297,in,O
298,provinces,O
299,that,O
300,actively,O
301,involved,O
302,in,O
303,foreign,O
304,trade,O
305,activities,O
306,.,O
307,Victims,O
308,include,O
309,trade,O
310,agencies,O
311,and,O
312,related,O
313,organizations,O
314,.,O
315,III,O
316,Attack,O
317,Procedure,O
318,Analysis,O
319,The,O
320,lure,O
321,documents,O
322,captured,O
323,in,O
324,this,O
325,attack,O
326,are,O
327,in,O
328,Yiddish,O
329,.,O
330,The,O
331,attackers,O
332,exploit,O
333,office,O
334,with,O
335,OLE,O
336,autolink,O
337,objects,O
338,(,O
339,CVE,O
340,-,O
341,2017,O
342,-,O
343,0199,O
344,),O
345,to,O
346,embed,O
347,the,O
348,documents,O
349,onto,O
350,malicious,O
351,websites,O
352,.,O
353,All,O
354,the,O
355,exploits,O
356,and,O
357,malicious,O
358,payload,O
359,were,O
360,uploaded,O
361,through,O
362,remote,O
363,servers,O
364,.,O
365,Once,O
366,victims,O
367,opened,O
368,the,O
369,lure,O
370,document,O
371,",",O
372,Word,O
373,will,O
374,firstly,O
375,visit,O
376,a,O
377,remote,O
378,website,O
379,of,O
380,IE,O
381,vbscript,O
382,0day,O
383,(,O
384,CVE,O
385,-,O
386,2018,O
387,-,O
388,8174,O
389,),O
390,to,O
391,trigger,O
392,the,O
393,exploit,O
394,.,O
395,Afterward,O
396,",",O
397,Shellcode,O
398,will,O
399,be,O
400,running,O
401,to,O
402,send,O
403,several,O
404,requests,O
405,to,O
406,get,O
407,payload,O
408,from,O
409,remote,O
410,servers,O
411,.,O
412,The,O
413,payload,O
414,will,O
415,then,O
416,be,O
417,decrypted,O
418,for,O
419,further,O
420,attack,O
421,.,O
422,While,O
423,the,O
424,payload,O
425,is,O
426,running,O
427,",",O
428,Word,O
429,will,O
430,release,O
431,three,O
432,DLL,O
433,backdoors,O
434,locally,O
435,.,O
436,The,O
437,backdoors,O
438,will,O
439,be,O
440,installed,O
441,and,O
442,executed,O
443,through,O
444,PowerShell,O
445,and,O
446,rundll32,O
447,.,O
448,UAC,O
449,bypass,O
450,was,O
451,used,O
452,in,O
453,this,O
454,process,O
455,",",O
456,as,O
457,well,O
458,as,O
459,file,O
460,steganography,O
461,and,O
462,memory,O
463,reflection,O
464,uploading,O
465,",",O
466,in,O
467,order,O
468,to,O
469,bypass,O
470,traffic,O
471,detection,O
472,and,O
473,to,O
474,complete,O
475,loading,O
476,without,O
477,any,O
478,files,O
479,.,O
480,IV,O
481,IE,O
482,VBScript,O
483,0day,O
484,(,O
485,CVE,O
486,-,O
487,2018,O
488,-,O
489,8174,O
490,),O
491,1,O
492,.,O
493,Timeline,O
494,On,O
495,April,O
496,18,O
497,",",O
498,2018,O
499,",",O
500,Advanced,O
501,Threat,O
502,Response,O
503,Team,O
504,of,O
505,360,O
506,Core,O
507,Security,O
508,Division,O
509,detected,O
510,a,O
511,high,O
512,-,O
513,risk,O
514,0day,O
515,vulnerabilities,O
516,.,O
517,The,O
518,vulnerability,O
519,affects,O
520,the,O
521,latest,O
522,version,O
523,of,O
524,Internet,O
525,Explorer,O
526,and,O
527,applications,O
528,that,O
529,use,O
530,the,O
531,IE,O
532,kernel,O
533,and,O
534,has,O
535,been,O
536,found,O
537,to,O
538,be,O
539,used,O
540,for,O
541,targeted,O
542,APT,O
543,attacks,O
544,.,O
545,On,O
546,the,O
547,same,O
548,day,O
549,",",O
550,360,O
551,immediately,O
552,communicated,O
553,with,O
554,Microsoft,O
555,and,O
556,submitted,O
557,details,O
558,of,O
559,the,O
560,vulnerability,O
561,to,O
562,Microsoft,O
563,.,O
564,Microsoft,O
565,confirmed,O
566,this,O
567,vulnerability,O
568,on,O
569,the,O
570,morning,O
571,of,O
572,April,O
573,20th,O
574,and,O
575,released,O
576,an,O
577,official,O
578,security,O
579,patch,O
580,on,O
581,May,O
582,8th,O
583,.,O
584,The,O
585,0day,O
586,vulnerability,O
587,was,O
588,fixed,O
589,and,O
590,it,O
591,was,O
592,named,O
593,CVE,O
594,-,O
595,2018,O
596,-,O
597,8174,O
598,.,O
599,CVE,O
600,-,O
601,2018,O
602,-,O
603,8174,O
604,is,O
605,a,O
606,remote,O
607,code,O
608,execution,O
609,vulnerability,O
610,of,O
611,Windows,O
612,VBScript,O
613,engine,O
614,.,O
615,Attackers,O
616,can,O
617,embed,O
618,malicious,O
619,VBScript,O
620,to,O
621,Office,O
622,document,O
623,or,O
624,website,O
625,and,O
626,then,O
627,obtain,O
628,the,O
629,credential,O
630,of,O
631,the,O
632,current,O
633,user,O
634,",",O
635,whenever,O
636,the,O
637,user,O
638,clicks,O
639,",",O
640,to,O
641,execute,O
642,arbitrary,O
643,code,O
644,.,O
645,2,O
646,.,O
647,Vulnerability,O
648,Principles,O
649,Through,O
650,the,O
651,statistical,O
652,analysis,O
653,of,O
654,the,O
655,vulnerability,O
656,samples,O
657,",",O
658,we,O
659,found,O
660,out,O
661,that,O
662,obfuscation,O
663,was,O
664,used,O
665,massively,O
666,.,O
667,Therefore,O
668,",",O
669,we,O
670,filtered,O
671,out,O
672,all,O
673,the,O
674,duplicated,O
675,obfuscation,O
676,and,O
677,renamed,O
678,all,O
679,the,O
680,identifiers,O
681,.,O
682,Seeing,O
683,from,O
684,the,O
685,POC,O
686,created,O
687,by,O
688,using,O
689,the,O
690,exploit,O
691,samples,O
692,we,O
693,captured,O
694,",",O
695,the,O
696,principles,O
697,of,O
698,the,O
699,exploit,O
700,is,O
701,obvious,O
702,.,O
703,The,O
704,POC,O
705,samples,O
706,are,O
707,as,O
708,below,O
709,:,O
710,Detailed,O
711,procedures,O
712,:,O
713,1,O
714,),O
715,First,O
716,create,O
717,a,O
718,cla1,O
719,instance,O
720,assigned,O
721,to,O
722,b,O
723,",",O
724,and,O
725,then,O
726,assign,O
727,value,O
728,0,O
729,to,O
730,b,O
731,",",O
732,because,O
733,at,O
734,this,O
735,point,O
736,b,O
737,’,O
738,s,O
739,referenced,O
740,count,O
741,is,O
742,1,O
743,",",O
744,causing,O
745,cla1,O
746,’,O
747,s,O
748,Class_Terminate,O
749,function,O
750,to,O
751,be,O
752,called,O
753,.,O
754,2,O
755,),O
756,In,O
757,the,O
758,Class_Terminate,O
759,function,O
760,",",O
761,again,O
762,assign,O
763,b,O
764,to,O
765,c,O
766,and,O
767,assign,O
768,0,O
769,to,O
770,b,O
771,to,O
772,balance,O
773,the,O
774,reference,O
775,count,O
776,.,O
777,3,O
778,),O
779,After,O
780,the,O
781,Class_Terminate,O
782,return,O
783,",",O
784,the,O
785,memory,O
786,pointed,O
787,to,O
788,by,O
789,the,O
790,b,O
791,object,O
792,will,O
793,be,O
794,released,O
795,",",O
796,so,O
797,that,O
798,a,O
799,pointer,O
800,to,O
801,the,O
802,memory,O
803,data,O
804,of,O
805,the,O
806,released,O
807,object,O
808,b,O
809,is,O
810,obtained,O
811,.,O
812,4,O
813,),O
814,If,O
815,you,O
816,use,O
817,another,O
818,object,O
819,to,O
820,occupy,O
821,the,O
822,freed,O
823,memory,O
824,",",O
825,it,O
826,will,O
827,lead,O
828,to,O
829,the,O
830,typical,O
831,UAF,O
832,or,O
833,Type,O
834,Confusion,O
835,problem,O
836,3,O
837,.,O
838,Exploitation,O
839,The,O
840,0,O
841,-,O
842,day,O
843,exploit,O
844,exploits,O
845,UAF,O
846,multiple,O
847,times,O
848,to,O
849,accomplish,O
850,type,O
851,confusion,O
852,.,O
853,It,O
854,fakes,O
855,and,O
856,overrides,O
857,the,O
858,array,O
859,object,O
860,to,O
861,perform,O
862,arbitrary,O
863,address,O
864,reading,O
865,and,O
866,writing,O
867,.,O
868,In,O
869,the,O
870,end,O
871,",",O
872,it,O
873,releases,O
874,code,O
875,to,O
876,execute,O
877,after,O
878,constructing,O
879,an,O
880,object,O
881,.,O
882,Code,O
883,execution,O
884,does,O
885,not,O
886,use,O
887,the,O
888,traditional,O
889,ROP,O
890,or,O
891,GodMod,O
892,",",O
893,but,O
894,through,O
895,the,O
896,script,O
897,layout,O
898,Shellcode,O
899,to,O
900,stabilize,O
901,the,O
902,use,O
903,.,O
904,Fake,O
905,array,O
906,to,O
907,perform,O
908,arbitrary,O
909,address,O
910,reading,O
911,and,O
912,writing,O
913,Mem,O
914,members,O
915,of,O
916,2,O
917,classes,O
918,created,O
919,by,O
920,UAF,O
921,are,O
922,offset,O
923,by,O
924,0x0c,O
925,bytes,O
926,",",O
927,and,O
928,an,O
929,array,O
930,of,O
931,0x7fffffff,O
932,size,O
933,is,O
934,forged,O
935,by,O
936,reading,O
937,and,O
938,writing,O
939,operation,O
940,to,O
941,the,O
942,two,O
943,mem,O
944,members,O
945,.,O
946,typedef,O
947,struct,O
948,tagSAFEARRAY,O
949,{,O
950,USHORT,O
951,cDims,O
952,;,O
953,//,O
954,cDims,O
955,=,O
956,0001,O
957,USHORT,O
958,fFeatures,O
959,;,O
960,fFeatures,O
961,=,O
962,0x0880,O
963,ULONG,O
964,cbElements,O
965,;,O
966,//,O
967,the,O
968,byte,O
969,occupied,O
970,by,O
971,one,O
972,element,O
973,(,O
974,1,O
975,byte,O
976,),O
977,ULONG,O
978,cLocks,O
979,;,O
980,PVOID,O
981,pvData,O
982,;,O
983,//,O
984,Buffer,O
985,of,O
986,data,O
987,starts,O
988,from,O
989,0x0,O
990,SAFEARRAYBOUND,O
991,rgsabound,O
992,[,O
993,1,O
994,];,O
995,},O
996,SAFEARRAY,O
997,",",O
998,*,O
999,LPSAFEARRAY,O
1000,;,O
1001,typedef,O
1002,struct,O
1003,tagSAFEARRAYBOUND,O
1004,{,O
1005,ULONG,O
1006,cElements,O
1007,;,O
1008,//,O
1009,the,O
1010,number,O
1011,of,O
1012,elements,O
1013,(,O
1014,0x7fffffff,O
1015,",",O
1016,user,O
1017,space,O
1018,),O
1019,LONG,O
1020,lLbound,O
1021,;,O
1022,//,O
1023,the,O
1024,initial,O
1025,value,O
1026,of,O
1027,the,O
1028,index,O
1029,(,O
1030,starting,O
1031,from,O
1032,0,O
1033,),O
1034,},O
1035,SAFEARRAYBOUND,O
1036,",",O
1037,*,O
1038,LPSAFEARRAYBOUND,O
1039,;,O
1040,A,O
1041,forged,O
1042,array,O
1043,composes,O
1044,of,O
1045,a,O
1046,one,O
1047,-,O
1048,dimensional,O
1049,array,O
1050,",",O
1051,the,O
1052,number,O
1053,of,O
1054,elements,O
1055,is,O
1056,7fffffff,O
1057,",",O
1058,each,O
1059,element,O
1060,occupies,O
1061,1,O
1062,byte,O
1063,",",O
1064,and,O
1065,the,O
1066,element,O
1067,memory,O
1068,address,O
1069,is,O
1070,0,O
1071,.,O
1072,So,O
1073,the,O
1074,accessible,O
1075,memory,O
1076,space,O
1077,for,O
1078,the,O
1079,array,O
1080,is,O
1081,from,O
1082,0x00000000,O
1083,to,O
1084,0x7ffffffff,O
1085,*,O
1086,1,O
1087,.,O
1088,Therefore,O
1089,",",O
1090,the,O
1091,array,O
1092,can,O
1093,be,O
1094,read,O
1095,and,O
1096,written,O
1097,at,O
1098,any,O
1099,address,O
1100,.,O
1101,But,O
1102,the,O
1103,storage,O
1104,type,O
1105,of,O
1106,lIlIIl,O
1107,is,O
1108,string,O
1109,",",O
1110,so,O
1111,only,O
1112,by,O
1113,modifying,O
1114,the,O
1115,data,O
1116,type,O
1117,to,O
1118,0x200C,O
1119,",",O
1120,i,O
1121,.,O
1122,e,O
1123,.,O
1124,VT_VARIANT,O
1125,|,O
1126,VT_ARRAY,O
1127,(,O
1128,array,O
1129,type,O
1130,"),",O
1131,attackers,O
1132,can,O
1133,achieve,O
1134,their,O
1135,purpose,O
1136,.,O
1137,Read,O
1138,the,O
1139,storage,O
1140,data,O
1141,of,O
1142,the,O
1143,specified,O
1144,parameter,O
1145,In,O
1146,the,O
1147,malicious,O
1148,code,O
1149,",",O
1150,the,O
1151,above,O
1152,function,O
1153,is,O
1154,mainly,O
1155,used,O
1156,to,O
1157,read,O
1158,the,O
1159,data,O
1160,of,O
1161,the,O
1162,memory,O
1163,address,O
1164,specified,O
1165,by,O
1166,the,O
1167,parameter,O
1168,.,O
1169,The,O
1170,idea,O
1171,is,O
1172,to,O
1173,obtain,O
1174,the,O
1175,specified,O
1176,memory,O
1177,read,O
1178,capability,O
1179,via,O
1180,the,O
1181,characteristics,O
1182,of,O
1183,the,O
1184,first,O
1185,4,O
1186,bytes,O
1187,of,O
1188,the,O
1189,string,O
1190,address,O
1191,(,O
1192,namely,O
1193,",",O
1194,the,O
1195,content,O
1196,of,O
1197,the,O
1198,bstr,O
1199,",",O
1200,type,O
1201,",",O
1202,size,O
1203,field,O
1204,),O
1205,returned,O
1206,by,O
1207,the,O
1208,lenb,O
1209,(,O
1210,bstr,O
1211,xx,O
1212,),O
1213,in,O
1214,the,O
1215,vb,O
1216,(,O
1217,the,O
1218,data,O
1219,type,O
1220,in,O
1221,the,O
1222,VBS,O
1223,is,O
1224,bstr,O
1225,).,O
1226,This,O
1227,is,O
1228,shown,O
1229,in,O
1230,the,O
1231,above,O
1232,code,O
1233,.,O
1234,If,O
1235,the,O
1236,input,O
1237,argument,O
1238,is,O
1239,addr,O
1240,(,O
1241,0x11223344,O
1242,"),",O
1243,first,O
1244,add,O
1245,4,O
1246,to,O
1247,the,O
1248,value,O
1249,to,O
1250,get,O
1251,0x11223348,O
1252,",",O
1253,and,O
1254,then,O
1255,set,O
1256,the,O
1257,variant,O
1258,type,O
1259,to,O
1260,8,O
1261,(,O
1262,string,O
1263,type,O
1264,).,O
1265,Next,O
1266,",",O
1267,call,O
1268,len,O
1269,function,O
1270,:,O
1271,if,O
1272,found,O
1273,to,O
1274,be,O
1275,BSTR,O
1276,type,O
1277,",",O
1278,vbscript,O
1279,will,O
1280,assume,O
1281,that,O
1282,the,O
1283,forward,O
1284,4,O
1285,bytes,O
1286,(,O
1287,0x11223344,O
1288,),O
1289,is,O
1290,the,O
1291,address,O
1292,memory,O
1293,to,O
1294,store,O
1295,the,O
1296,length,O
1297,.,O
1298,So,O
1299,the,O
1300,len,O
1301,function,O
1302,will,O
1303,be,O
1304,executed,O
1305,and,O
1306,the,O
1307,value,O
1308,of,O
1309,the,O
1310,specified,O
1311,memory,O
1312,address,O
1313,will,O
1314,be,O
1315,returned,O
1316,.,O
1317,Obtain,O
1318,Key,O
1319,DLL,O
1320,Base,O
1321,Address,O
1322,The,O
1323,attacker,O
1324,leaks,O
1325,the,O
1326,virtual,O
1327,function,O
1328,table,O
1329,address,O
1330,of,O
1331,the,O
1332,CScriptEntryPoint,O
1333,object,O
1334,in,O
1335,the,O
1336,following,O
1337,way,O
1338,",",O
1339,which,O
1340,belongs,O
1341,to,O
1342,Vbscript,O
1343,.,O
1344,dll,O
1345,.,O
1346,Obtain,O
1347,the,O
1348,vbscript,O
1349,.,O
1350,dll,O
1351,base,O
1352,address,O
1353,in,O
1354,the,O
1355,following,O
1356,way,O
1357,.,O
1358,Because,O
1359,vbscript,O
1360,.,O
1361,dll,O
1362,imported,O
1363,msvcrt,O
1364,.,O
1365,dll,O
1366,",",O
1367,the,O
1368,msvcrt,O
1369,.,O
1370,dll,O
1371,base,O
1372,address,O
1373,was,O
1374,obtained,O
1375,by,O
1376,traversing,O
1377,the,O
1378,vbscript,O
1379,.,O
1380,dll,O
1381,import,O
1382,table,O
1383,",",O
1384,msvcrt,O
1385,.,O
1386,dll,O
1387,introduces,O
1388,kernelbase,O
1389,.,O
1390,dll,O
1391,",",O
1392,ntdll,O
1393,.,O
1394,dll,O
1395,",",O
1396,and,O
1397,finally,O
1398,the,O
1399,NtContinue,O
1400,",",O
1401,VirtualProtect,O
1402,function,O
1403,address,O
1404,was,O
1405,obtained,O
1406,.,O
1407,Bypass,O
1408,DEP,O
1409,to,O
1410,execute,O
1411,shellcode,O
1412,Use,O
1413,arbitrary,O
1414,reading,O
1415,and,O
1416,writing,O
1417,technique,O
1418,to,O
1419,modify,O
1420,the,O
1421,VAR,O
1422,type,O
1423,type,O
1424,to,O
1425,0x4d,O
1426,",",O
1427,and,O
1428,then,O
1429,assign,O
1430,it,O
1431,with,O
1432,a,O
1433,value,O
1434,of,O
1435,0,O
1436,to,O
1437,make,O
1438,the,O
1439,virtual,O
1440,machine,O
1441,perform,O
1442,VAR,O
1443,::,O
1444,Clear,O
1445,function,O
1446,.,O
1447,Control,O
1448,with,O
1449,caution,O
1450,and,O
1451,let,O
1452,the,O
1453,code,O
1454,Execute,O
1455,function,O
1456,ntdll,O
1457,!,O
1458,ZwContinue,O
1459,.,O
1460,The,O
1461,first,O
1462,parameter,O
1463,CONTEXT,O
1464,structure,O
1465,was,O
1466,also,O
1467,constructed,O
1468,by,O
1469,the,O
1470,attacker,O
1471,.,O
1472,Control,O
1473,the,O
1474,code,O
1475,with,O
1476,caution,O
1477,to,O
1478,execute,O
1479,ntdll,O
1480,!,O
1481,ZwContinue,O
1482,function,O
1483,.,O
1484,The,O
1485,first,O
1486,parameter,O
1487,CONTEXT,O
1488,structure,O
1489,is,O
1490,also,O
1491,carefully,O
1492,constructed,O
1493,by,O
1494,the,O
1495,attacker,O
1496,.,O
1497,The,O
1498,first,O
1499,parameter,O
1500,of,O
1501,ZwContinue,O
1502,is,O
1503,a,O
1504,pointer,O
1505,to,O
1506,the,O
1507,CONTEXT,O
1508,structure,O
1509,.,O
1510,The,O
1511,CONTEXT,O
1512,structure,O
1513,is,O
1514,shown,O
1515,in,O
1516,the,O
1517,following,O
1518,figure,O
1519,",",O
1520,and,O
1521,the,O
1522,offset,O
1523,of,O
1524,EIP,O
1525,and,O
1526,ESP,O
1527,in,O
1528,CONTEXT,O
1529,can,O
1530,be,O
1531,calculated,O
1532,.,O
1533,5,O
1534,.,O
1535,The,O
1536,values,O
1537,of,O
1538,the,O
1539,Eip,O
1540,and,O
1541,Esp,O
1542,in,O
1543,the,O
1544,actual,O
1545,runtime,O
1546,CONTEXT,O
1547,and,O
1548,the,O
1549,attacker,O
1550,’,O
1551,s,O
1552,intention,O
1553,are,O
1554,shown,O
1555,in,O
1556,the,O
1557,figure,O
1558,below,O
1559,.,O
1560,V,O
1561,Powershell,O
1562,Payload,O
1563,After,O
1564,the,O
1565,bait,O
1566,DOC,O
1567,file,O
1568,is,O
1569,executed,O
1570,",",O
1571,it,O
1572,will,O
1573,start,O
1574,to,O
1575,execute,O
1576,the,O
1577,Powershell,O
1578,command,O
1579,to,O
1580,the,O
1581,next,O
1582,step,O
1583,payload,O
1584,.,O
1585,First,O
1586,of,O
1587,all,O
1588,",",O
1589,Powershell,O
1590,will,O
1591,fuzzy,O
1592,match,O
1593,incoming,O
1594,parameter,O
1595,names,O
1596,",",O
1597,and,O
1598,it,O
1599,is,O
1600,case,O
1601,-,O
1602,insensitive,O
1603,.,O
1604,Second,O
1605,step,O
1606,",",O
1607,decrypt,O
1608,the,O
1609,obfuscated,O
1610,command,O
1611,.,O
1612,Next,O
1613,",",O
1614,the,O
1615,script,O
1616,uses,O
1617,a,O
1618,special,O
1619,User,O
1620,-,O
1621,Agent,O
1622,access,O
1623,URL,O
1624,page,O
1625,to,O
1626,request,O
1627,the,O
1628,next,O
1629,load,O
1630,and,O
1631,execute,O
1632,.,O
1633,The,O
1634,size,O
1635,of,O
1636,the,O
1637,requested,O
1638,payload,O
1639,file,O
1640,is,O
1641,approximately,O
1642,199K,O
1643,.,O
1644,The,O
1645,code,O
1646,fragment,O
1647,is,O
1648,as,O
1649,follows,O
1650,.,O
1651,We,O
1652,found,O
1653,that,O
1654,this,O
1655,code,O
1656,was,O
1657,modified,O
1658,from,O
1659,invoke,O
1660,-,O
1661,ReflectivePEInjection,O
1662,.,O
1663,ps1,O
1664,.,O
1665,buffer_x86,O
1666,and,O
1667,buffer_x64,O
1668,in,O
1669,the,O
1670,code,O
1671,are,O
1672,the,O
1673,same,O
1674,function,O
1675,but,O
1676,from,O
1677,different,O
1678,versions,O
1679,of,O
1680,dll,O
1681,files,O
1682,.,O
1683,File,O
1684,export,O
1685,module,O
1686,name,O
1687,:,O
1688,ReverseMet,O
1689,.,O
1690,dll,O
1691,.,O
1692,DLL,O
1693,file,O
1694,decrypts,O
1695,ip,O
1696,address,O
1697,",",O
1698,port,O
1699,and,O
1700,sleep,O
1701,time,O
1702,from,O
1703,the,O
1704,configuration,O
1705,.,O
1706,After,O
1707,the,O
1708,decryption,O
1709,algorithm,O
1710,xor,O
1711,0xA4,O
1712,",",O
1713,and,O
1714,subtracted,O
1715,0x34,O
1716,",",O
1717,the,O
1718,code,O
1719,is,O
1720,as,O
1721,follows,O
1722,.,O
1723,Decryption,O
1724,configuration,O
1725,file,O
1726,from,O
1727,the,O
1728,ip,O
1729,address,O
1730,185,O
1731,.,O
1732,183,O
1733,.,O
1734,97,O
1735,.,O
1736,28,O
1737,port,O
1738,1021,O
1739,to,O
1740,obtain,O
1741,the,O
1742,next,O
1743,load,O
1744,and,O
1745,execute,O
1746,.,O
1747,After,O
1748,it,O
1749,connects,O
1750,to,O
1751,the,O
1752,tcp,O
1753,port,O
1754,",",O
1755,it,O
1756,will,O
1757,get,O
1758,4,O
1759,bytes,O
1760,to,O
1761,apply,O
1762,for,O
1763,a,O
1764,memory,O
1765,.,O
1766,Subsequent,O
1767,acquired,O
1768,writes,O
1769,into,O
1770,the,O
1771,new,O
1772,thread,O
1773,",",O
1774,and,O
1775,execute,O
1776,the,O
1777,acquired,O
1778,shellcode,O
1779,payload,O
1780,",",O
1781,Since,O
1782,the,O
1783,port,O
1784,of,O
1785,the,O
1786,sample,O
1787,CC,O
1788,server,O
1789,is,O
1790,closed,O
1791,",",O
1792,we,O
1793,cannot,O
1794,get,O
1795,the,O
1796,next,O
1797,load,O
1798,for,O
1799,analysis,O
1800,.,O
1801,VI,O
1802,UAC,O
1803,Bypass,O
1804,Payload,O
1805,In,O
1806,addition,O
1807,to,O
1808,use,O
1809,PowerShell,O
1810,to,O
1811,load,O
1812,the,O
1813,payload,O
1814,",",O
1815,the,O
1816,bait,O
1817,DOC,O
1818,file,O
1819,also,O
1820,runs,O
1821,rundll32,O
1822,.,O
1823,exe,O
1824,to,O
1825,execute,O
1826,another,O
1827,backdoor,O
1828,locally,O
1829,.,O
1830,There,O
1831,are,O
1832,several,O
1833,notable,O
1834,features,O
1835,of,O
1836,the,O
1837,backdoor,O
1838,program,O
1839,it,O
1840,uses,O
1841,:,O
1842,the,O
1843,program,O
1844,uses,O
1845,COM,O
1846,port,O
1847,to,O
1848,copy,O
1849,files,O
1850,",",O
1851,realize,O
1852,UAC,O
1853,bypass,O
1854,and,O
1855,two,O
1856,system,O
1857,DLL,O
1858,hijacks,O
1859,;,O
1860,it,O
1861,also,O
1862,uses,O
1863,the,O
1864,default,O
1865,DLLs,O
1866,of,O
1867,cliconfg,O
1868,.,O
1869,exe,O
1870,and,O
1871,SearchProtocolHost,O
1872,.,O
1873,exe,O
1874,to,O
1875,take,O
1876,advantage,O
1877,of,O
1878,whitelist,O
1879,;,O
1880,finally,O
1881,in,O
1882,the,O
1883,process,O
1884,of,O
1885,component,O
1886,delivery,O
1887,",",O
1888,use,O
1889,file,O
1890,steganography,O
1891,and,O
1892,memory,O
1893,reflection,O
1894,loading,O
1895,method,O
1896,to,O
1897,avoid,O
1898,traffic,O
1899,monitoring,O
1900,and,O
1901,achieve,O
1902,no,O
1903,file,O
1904,landing,O
1905,load,O
1906,.,O
1907,1,O
1908,.,O
1909,Retro,O
1910,backdoor,O
1911,execution,O
1912,The,O
1913,backdoor,O
1914,program,O
1915,used,O
1916,in,O
1917,this,O
1918,attack,O
1919,is,O
1920,actually,O
1921,the,O
1922,Retro,O
1923,series,O
1924,backdoor,O
1925,known,O
1926,to,O
1927,be,O
1928,used,O
1929,by,O
1930,the,O
1931,APT,O
1932,-,O
1933,C,O
1934,-,O
1935,06,O
1936,organization,O
1937,.,O
1938,The,O
1939,following,O
1940,is,O
1941,a,O
1942,detailed,O
1943,analysis,O
1944,of,O
1945,the,O
1946,implementation,O
1947,process,O
1948,of,O
1949,the,O
1950,backdoor,O
1951,program,O
1952,.,O
1953,First,O
1954,execute,O
1955,the,O
1956,DLL,O
1957,disguised,O
1958,as,O
1959,a,O
1960,zlib,O
1961,library,O
1962,function,O
1963,with,O
1964,rundll32,O
1965,and,O
1966,execute,O
1967,the,O
1968,backdoor,O
1969,installation,O
1970,functions,O
1971,uncompress2,O
1972,and,O
1973,uncompress3,O
1974,.,O
1975,It,O
1976,uses,O
1977,a,O
1978,COM,O
1979,port,O
1980,for,O
1981,UAC,O
1982,bypass,O
1983,",",O
1984,copying,O
1985,its,O
1986,own,O
1987,DLL,O
1988,to,O
1989,the,O
1990,System32,O
1991,path,O
1992,for,O
1993,DLL,O
1994,hijacking,O
1995,",",O
1996,and,O
1997,the,O
1998,hijacked,O
1999,targets,O
2000,are,O
2001,cliconfg,O
2002,.,O
2003,exe,O
2004,and,O
2005,SearchProtocolHost,O
2006,.,O
2007,exe,O
2008,Copy,O
2009,the,O
2010,DLL,O
2011,file,O
2012,in,O
2013,the,O
2014,AppData,O
2015,directory,O
2016,to,O
2017,the,O
2018,System32,O
2019,directory,O
2020,through,O
2021,the,O
2022,COM,O
2023,interface,O
2024,and,O
2025,name,O
2026,it,O
2027,msfte,O
2028,.,O
2029,dll,O
2030,and,O
2031,NTWDBLIB,O
2032,.,O
2033,dll,O
2034,.,O
2035,Then,O
2036,copy,O
2037,the,O
2038,file,O
2039,NTWDBLIB,O
2040,.,O
2041,dll,O
2042,to,O
2043,the,O
2044,System,O
2045,directory,O
2046,and,O
2047,execute,O
2048,the,O
2049,system,O
2050,’,O
2051,s,O
2052,own,O
2053,cliconfig,O
2054,to,O
2055,achieve,O
2056,DLL,O
2057,hijacking,O
2058,and,O
2059,load,O
2060,NTWDBLIB,O
2061,.,O
2062,dll,O
2063,.,O
2064,The,O
2065,role,O
2066,of,O
2067,NTWDBLIB,O
2068,.,O
2069,dll,O
2070,is,O
2071,to,O
2072,restart,O
2073,the,O
2074,system,O
2075,service,O
2076,WSearch,O
2077,",",O
2078,and,O
2079,then,O
2080,start,O
2081,msfte,O
2082,.,O
2083,dll,O
2084,.,O
2085,The,O
2086,script,O
2087,will,O
2088,then,O
2089,generate,O
2090,and,O
2091,execute,O
2092,the,O
2093,MO4TH2H0,O
2094,.,O
2095,bat,O
2096,file,O
2097,in,O
2098,the,O
2099,TEMP,O
2100,directory,O
2101,",",O
2102,which,O
2103,will,O
2104,delete,O
2105,the,O
2106,NTWDBLIB,O
2107,.,O
2108,DLL,O
2109,and,O
2110,its,O
2111,own,O
2112,BAT,O
2113,from,O
2114,the,O
2115,system,O
2116,directory,O
2117,.,O
2118,Msfte,O
2119,.,O
2120,dll,O
2121,is,O
2122,the,O
2123,final,O
2124,backdoor,O
2125,program,O
2126,whose,O
2127,export,O
2128,is,O
2129,disguised,O
2130,as,O
2131,zlib,O
2132,.,O
2133,The,O
2134,core,O
2135,export,O
2136,functions,O
2137,are,O
2138,AccessDebugTracer,O
2139,and,O
2140,AccessRetailTracer,O
2141,.,O
2142,Its,O
2143,main,O
2144,function,O
2145,is,O
2146,to,O
2147,communicate,O
2148,with,O
2149,CC,O
2150,and,O
2151,further,O
2152,download,O
2153,and,O
2154,execute,O
2155,subsequent,O
2156,DLL,O
2157,programs,O
2158,.,O
2159,Similar,O
2160,to,O
2161,the,O
2162,previously,O
2163,analyzed,O
2164,sample,O
2165,",",O
2166,it,O
2167,is,O
2168,also,O
2169,using,O
2170,image,O
2171,steganography,O
2172,and,O
2173,memory,O
2174,reflection,O
2175,loading,O
2176,.,O
2177,The,O
2178,decrypted,O
2179,CC,O
2180,communication,O
2181,information,O
2182,is,O
2183,as,O
2184,follows,O
2185,:,O
2186,The,O
2187,format,O
2188,of,O
2189,the,O
2190,request,O
2191,is,O
2192,:,O
2193,Hxxp,O
2194,://,O
2195,CC_Address,O
2196,/,O
2197,s7,O
2198,/,O
2199,config,O
2200,.,O
2201,php,O
2202,?,O
2203,p,O
2204,=,O
2205,M,O
2206,&,O
2207,inst,O
2208,=,O
2209,7917,O
2210,&,O
2211,name,O
2212,=,O
2213,Among,O
2214,them,O
2215,",",O
2216,the,O
2217,parameter,O
2218,p,O
2219,is,O
2220,the,O
2221,current,O
2222,process,O
2223,authority,O
2224,",",O
2225,there,O
2226,are,O
2227,two,O
2228,types,O
2229,of,O
2230,M,O
2231,and,O
2232,H,O
2233,",",O
2234,inst,O
2235,parameter,O
2236,is,O
2237,the,O
2238,current,O
2239,installation,O
2240,id,O
2241,",",O
2242,name,O
2243,is,O
2244,the,O
2245,CC_name,O
2246,obtained,O
2247,by,O
2248,decryption,O
2249,",",O
2250,this,O
2251,time,O
2252,is,O
2253,pphp,O
2254,.,O
2255,After,O
2256,decryption,O
2257,after,O
2258,downloading,O
2259,",",O
2260,the,O
2261,process,O
2262,is,O
2263,exactly,O
2264,the,O
2265,same,O
2266,as,O
2267,the,O
2268,format,O
2269,of,O
2270,the,O
2271,previous,O
2272,image,O
2273,steganography,O
2274,transmission,O
2275,.,O
2276,For,O
2277,the,O
2278,CC,O
2279,URL,O
2280,corresponding,O
2281,to,O
2282,the,O
2283,test,O
2284,request,O
2285,",",O
2286,because,O
2287,we,O
2288,did,O
2289,not,O
2290,obtain,O
2291,the,O
2292,corresponding,O
2293,image,O
2294,during,O
2295,the,O
2296,analysis,O
2297,",",O
2298,the,O
2299,CC,O
2300,is,O
2301,suspected,O
2302,to,O
2303,have,O
2304,failed,O
2305,.,O
2306,In,O
2307,the,O
2308,implementation,O
2309,process,O
2310,",",O
2311,Retro,O
2312,disguised,O
2313,fake,O
2314,SSH,O
2315,and,O
2316,fake,O
2317,zlib,O
2318,",",O
2319,intended,O
2320,to,O
2321,obfuscate,O
2322,and,O
2323,interfere,O
2324,with,O
2325,users,O
2326,and,O
2327,analysts,O
2328,.,O
2329,Retro,O
2330,’,O
2331,s,O
2332,attack,O
2333,method,O
2334,has,O
2335,been,O
2336,used,O
2337,since,O
2338,2016,O
2339,.,O
2340,2,O
2341,.,O
2342,Retro,O
2343,backdoor,O
2344,evolvement,O
2345,The,O
2346,back,O
2347,door,O
2348,program,O
2349,used,O
2350,in,O
2351,the,O
2352,APT,O
2353,-,O
2354,C,O
2355,-,O
2356,06,O
2357,organization,O
2358,’,O
2359,s,O
2360,early,O
2361,APT,O
2362,operation,O
2363,was,O
2364,Lucker,B-Malware
2365,.,O
2366,It,O
2367,is,O
2368,a,O
2369,set,O
2370,of,O
2371,self,O
2372,-,O
2373,developed,O
2374,and,O
2375,customized,O
2376,modular,O
2377,Trojans,O
2378,.,O
2379,The,O
2380,set,O
2381,of,O
2382,Trojans,O
2383,is,O
2384,powerful,O
2385,",",O
2386,with,O
2387,keyboard,O
2388,recording,O
2389,",",O
2390,voice,O
2391,recording,O
2392,",",O
2393,screen,O
2394,capture,O
2395,",",O
2396,file,O
2397,capture,O
2398,and,O
2399,U,O
2400,disk,O
2401,operation,O
2402,functions,O
2403,",",O
2404,etc,O
2405,.,O
2406,The,O
2407,Lucker,B-Malware
2408,‘,O
2409,s,O
2410,name,O
2411,comes,O
2412,from,O
2413,the,O
2414,PDB,O
2415,path,O
2416,of,O
2417,this,O
2418,type,O
2419,of,O
2420,Trojan,O
2421,",",O
2422,because,O
2423,most,O
2424,of,O
2425,the,O
2426,backdoor,O
2427,’,O
2428,s,O
2429,function,O
2430,use,O
2431,the,O
2432,LK,O
2433,abbreviation,O
2434,.,O
2435,In,O
2436,the,O
2437,middle,O
2438,to,O
2439,late,O
2440,period,O
2441,we,O
2442,have,O
2443,discovered,O
2444,its,O
2445,evolution,O
2446,and,O
2447,two,O
2448,different,O
2449,types,O
2450,of,O
2451,backdoor,O
2452,programs,O
2453,.,O
2454,We,O
2455,have,O
2456,named,O
2457,them,O
2458,Retro,O
2459,and,O
2460,Collector,O
2461,by,O
2462,the,O
2463,PDB,O
2464,path,O
2465,extracted,O
2466,from,O
2467,the,O
2468,program,O
2469,.,O
2470,The,O
2471,Retro,O
2472,backdoor,O
2473,is,O
2474,an,O
2475,evolution,O
2476,of,O
2477,the,O
2478,Lucker,O
2479,backdoor,O
2480,and,O
2481,it,O
2482,actives,O
2483,in,O
2484,a,O
2485,series,O
2486,of,O
2487,attacks,O
2488,from,O
2489,2016,O
2490,till,O
2491,now,O
2492,.,O
2493,The,O
2494,name,O
2495,comes,O
2496,from,O
2497,the,O
2498,pdb,O
2499,path,O
2500,of,O
2501,this,O
2502,type,O
2503,of,O
2504,Trojan,O
2505,with,O
2506,the,O
2507,label,O
2508,Retro,O
2509,",",O
2510,and,O
2511,also,O
2512,has,O
2513,the,O
2514,word,O
2515,Retro,O
2516,in,O
2517,the,O
2518,initial,O
2519,installer,O
2520,.,O
2521,C,O
2522,:\,O
2523,workspace,O
2524,\,O
2525,Retro,O
2526,\,O
2527,DLL,O
2528,-,O
2529,injected,O
2530,-,O
2531,explorer,O
2532,\,O
2533,zlib1,O
2534,.,O
2535,pdb,O
2536,C,O
2537,:\,O
2538,workspace,O
2539,\,O
2540,Retro,O
2541,\,O
2542,RetroDLL,O
2543,\,O
2544,zlib1,O
2545,.,O
2546,pdb,O
2547,The,O
2548,evolution,O
2549,of,O
2550,the,O
2551,reflective,O
2552,DLL,O
2553,injection,O
2554,technique,O
2555,can,O
2556,be,O
2557,found,O
2558,from,O
2559,the,O
2560,relevant,O
2561,PDB,O
2562,paths,O
2563,",",O
2564,and,O
2565,there,O
2566,are,O
2567,a,O
2568,lot,O
2569,of,O
2570,variants,O
2571,of,O
2572,this,O
2573,series,O
2574,of,O
2575,backdoors,O
2576,.,O
2577,VII,O
2578,Attribution,O
2579,1,O
2580,.,O
2581,Decryption,O
2582,Algorithm,O
2583,During,O
2584,the,O
2585,analysis,O
2586,",",O
2587,we,O
2588,found,O
2589,the,O
2590,decryption,O
2591,algorithm,O
2592,that,O
2593,malware,O
2594,used,O
2595,is,O
2596,identical,O
2597,to,O
2598,APT,O
2599,-,O
2600,C,O
2601,-,O
2602,06,O
2603,’,O
2604,s,O
2605,decryption,O
2606,algorithm,O
2607,.,O
2608,In,O
2609,the,O
2610,further,O
2611,analysis,O
2612,",",O
2613,we,O
2614,found,O
2615,the,O
2616,same,O
2617,decryption,O
2618,algorithm,O
2619,was,O
2620,used,O
2621,in,O
2622,the,O
2623,64,O
2624,-,O
2625,bit,O
2626,version,O
2627,of,O
2628,the,O
2629,relevant,O
2630,malware,O
2631,.,O
2632,2,O
2633,.,O
2634,PDB,O
2635,Path,O
2636,The,O
2637,PDB,O
2638,path,O
2639,of,O
2640,the,O
2641,malware,O
2642,used,O
2643,in,O
2644,this,O
2645,attack,O
2646,has,O
2647,a,O
2648,string,O
2649,of,O
2650,“,O
2651,Retro,O
2652,”.,O
2653,It,O
2654,is,O
2655,one,O
2656,specific,O
2657,feature,O
2658,of,O
2659,Retro,O
2660,Trojan,O
2661,family,O
2662,.,O
2663,3,O
2664,.,O
2665,Victims,O
2666,In,O
2667,the,O
2668,process,O
2669,of,O
2670,tracing,O
2671,victims,O
2672,",",O
2673,we,O
2674,found,O
2675,one,O
2676,special,O
2677,compromised,O
2678,machine,O
2679,.,O
2680,It,O
2681,has,O
2682,a,O
2683,large,O
2684,amount,O
2685,of,O
2686,malware,O
2687,related,O
2688,to,O
2689,APT,O
2690,-,O
2691,C,O
2692,-,O
2693,06,O
2694,.,O
2695,By,O
2696,looking,O
2697,at,O
2698,these,O
2699,samples,O
2700,in,O
2701,chronological,O
2702,order,O
2703,",",O
2704,the,O
2705,evolution,O
2706,of,O
2707,the,O
2708,malicious,O
2709,program,O
2710,can,O
2711,be,O
2712,clearly,O
2713,seen,O
2714,.,O
2715,The,O
2716,victim,O
2717,has,O
2718,been,O
2719,under,O
2720,constant,O
2721,attack,O
2722,acted,O
2723,by,O
2724,APT,O
2725,-,O
2726,C,O
2727,-,O
2728,06,O
2729,since,O
2730,2015,O
2731,.,O
2732,The,O
2733,early,O
2734,samples,O
2735,on,O
2736,the,O
2737,compromised,O
2738,machine,O
2739,could,O
2740,be,O
2741,associated,O
2742,with,O
2743,DarkHotel,B-Actor
2744,.,O
2745,Then,O
2746,it,O
2747,was,O
2748,attacked,O
2749,by,O
2750,Lurker,B-Malware
2751,Trojan,O
2752,.,O
2753,Recently,O
2754,it,O
2755,was,O
2756,under,O
2757,the,O
2758,attack,O
2759,exploiting,O
2760,0,O
2761,-,O
2762,day,O
2763,vulnerabilities,O
2764,CVE,O
2765,-,O
2766,2018,O
2767,-,O
2768,8174,O
2769,.,O
2770,VIII,O
2771,Conclusion,O
2772,APT,O
2773,-,O
2774,C,O
2775,-,O
2776,06,O
2777,is,O
2778,an,O
2779,overseas,O
2780,APT,O
2781,organization,O
2782,which,O
2783,has,O
2784,been,O
2785,active,O
2786,for,O
2787,a,O
2788,long,O
2789,time,O
2790,.,O
2791,Its,O
2792,main,O
2793,targets,O
2794,are,O
2795,China,O
2796,and,O
2797,some,O
2798,other,O
2799,countries,O
2800,.,O
2801,Its,O
2802,main,O
2803,purpose,O
2804,is,O
2805,to,O
2806,steal,O
2807,sensitive,O
2808,data,O
2809,and,O
2810,conduct,O
2811,cyber,O
2812,-,O
2813,espionage,O
2814,.,O
2815,DarkHotel,B-Actor
2816,can,O
2817,be,O
2818,regarded,O
2819,as,O
2820,one,O
2821,of,O
2822,its,O
2823,series,O
2824,of,O
2825,attack,O
2826,activities,O
2827,.,O
2828,The,O
2829,attacks,O
2830,against,O
2831,China,O
2832,specifically,O
2833,targeted,O
2834,government,B-Target
2835,",",O
2836,scientific,B-Target
2837,research,I-Target
2838,institutions,I-Target
2839,and,O
2840,some,O
2841,particular,O
2842,field,O
2843,.,O
2844,The,O
2845,attacks,O
2846,can,O
2847,be,O
2848,dated,O
2849,back,O
2850,to,O
2851,2007,O
2852,and,O
2853,are,O
2854,still,O
2855,very,O
2856,active,O
2857,.,O
2858,Based,O
2859,on,O
2860,the,O
2861,evidence,O
2862,we,O
2863,have,O
2864,",",O
2865,the,O
2866,organization,O
2867,may,O
2868,be,O
2869,a,O
2870,hacker,O
2871,group,O
2872,or,O
2873,intelligence,O
2874,agency,O
2875,supported,O
2876,by,O
2877,a,O
2878,foreign,O
2879,government,O
2880,.,O
2881,The,O
2882,attacks,O
2883,against,O
2884,China,O
2885,have,O
2886,never,O
2887,stopped,O
2888,over,O
2889,the,O
2890,past,O
2891,10,O
2892,years,O
2893,.,O
2894,The,O
2895,Techniques,O
2896,the,O
2897,group,O
2898,uses,O
2899,keep,O
2900,evolving,O
2901,through,O
2902,time,O
2903,.,O
2904,Based,O
2905,on,O
2906,the,O
2907,data,O
2908,we,O
2909,captured,O
2910,in,O
2911,2017,O
2912,",",O
2913,targets,O
2914,in,O
2915,China,O
2916,are,O
2917,trade,O
2918,related,O
2919,institutions,O
2920,and,O
2921,concentrated,O
2922,in,O
2923,provinces,O
2924,that,O
2925,have,O
2926,frequent,O
2927,trading,O
2928,activities,O
2929,.,O
2930,The,O
2931,group,O
2932,has,O
2933,been,O
2934,conducting,O
2935,long,O
2936,-,O
2937,term,O
2938,monitoring,O
2939,on,O
2940,the,O
2941,targets,O
2942,to,O
2943,stole,O
2944,confidential,O
2945,data,O
2946,.,O
2947,During,O
2948,the,O
2949,decades,O
2950,of,O
2951,cyber,O
2952,attacks,O
2953,",",O
2954,APT,O
2955,-,O
2956,C,O
2957,-,O
2958,06,O
2959,exploits,O
2960,several,O
2961,0,O
2962,-,O
2963,day,O
2964,vulnerabilities,O
2965,and,O
2966,used,O
2967,complicated,O
2968,malware,O
2969,.,O
2970,It,O
2971,has,O
2972,dozens,O
2973,of,O
2974,function,O
2975,modules,O
2976,and,O
2977,over,O
2978,200,O
2979,malicious,O
2980,codes,O
2981,.,O
2982,In,O
2983,April,O
2984,",",O
2985,2018,O
2986,",",O
2987,the,O
2988,Advanced,O
2989,Threat,O
2990,Response,O
2991,Team,O
2992,of,O
2993,360,O
2994,Core,O
2995,Security,O
2996,Division,O
2997,takes,O
2998,the,O
2999,lead,O
3000,in,O
3001,capturing,O
3002,the,O
3003,group,O
3004,’,O
3005,s,O
3006,new,O
3007,APT,O
3008,attack,O
3009,using,O
3010,0,O
3011,-,O
3012,day,O
3013,vulnerabilities,O
3014,(,O
3015,CVE,O
3016,-,O
3017,2018,O
3018,-,O
3019,8174,O
3020,),O
3021,in,O
3022,the,O
3023,wild,O
3024,",",O
3025,and,O
3026,then,O
3027,discovers,O
3028,the,O
3029,new,O
3030,type,O
3031,attack,O
3032,–,O
3033,Office,O
3034,related,O
3035,attack,O
3036,exploiting,O
3037,0,O
3038,-,O
3039,day,O
3040,VBScript,O
3041,vulnerabilities,O
3042,.,O
3043,After,O
3044,the,O
3045,capture,O
3046,of,O
3047,the,O
3048,new,O
3049,activity,O
3050,",",O
3051,we,O
3052,contacted,O
3053,Microsoft,O
3054,immediately,O
3055,and,O
3056,shared,O
3057,detailed,O
3058,information,O
3059,with,O
3060,them,O
3061,.,O
3062,Microsoft,O
3063,’,O
3064,s,O
3065,official,O
3066,security,O
3067,patch,O
3068,was,O
3069,released,O
3070,on,O
3071,8th,O
3072,May,O
3073,.,O
3074,Now,O
3075,",",O
3076,we,O
3077,published,O
3078,this,O
3079,detailed,O
3080,report,O
3081,to,O
3082,disclose,O
3083,and,O
3084,analyze,O
3085,the,O
3086,attack,O
3087,.,O
3088,Further,O
3089,technical,O
3090,details,O
3091,including,O
3092,IoCs,O
3093,are,O
3094,reported,O
3095,in,O
3096,the,O
3097,analysis,O
3098,published,O
3099,by,O
3100,360,O
3101,Core,O
3102,Security,O
3103,Team,O
3104,at,O
3105,the,O
3106,following,O
3107,URL,O
3108,:,O
3109,http,O
3110,://,O
3111,blogs,O
3112,.,O
3113,360,O
3114,.,O
3115,cn,O
3116,/,O
3117,blog,O
3118,/,O
3119,cve,O
3120,-,O
3121,2018,O
3122,-,O
3123,8174,O
3124,-,O
3125,en,O
3126,/,O
3127,About,O
3128,the,O
3129,Author,O
3130,:,O
3131,360,O
3132,Core,O
3133,Security,O
3134,Team,O
3135,Pierluigi,O
3136,Paganini,O
3137,(,O
3138,Security,O
3139,Affairs,O
3140,–,O
3141,CVE,O
3142,-,O
3143,2018,O
3144,-,O
3145,8174,O
3146,",",O
3147,APT,O
3148,),O
3149,Share,O
3150,On,O
