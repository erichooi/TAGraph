,Text,Label
0,Security,O
1,experts,O
2,from,O
3,security,O
4,firm,O
5,Redsocks,O
6,published,O
7,an,O
8,interesting,O
9,report,O
10,on,O
11,how,O
12,to,O
13,crack,O
14,APT28,B-Actor
15,traffic,O
16,in,O
17,a,O
18,few,O
19,seconds,O
20,.,O
21,Introduction,O
22,APT28,B-Actor
23,is,O
24,a,O
25,hacking,O
26,group,O
27,involved,O
28,in,O
29,many,O
30,recent,O
31,cyber,O
32,incidents,O
33,.,O
34,The,O
35,most,O
36,recent,O
37,attack,O
38,allegedly,O
39,attributed,O
40,to,O
41,this,O
42,group,O
43,is,O
44,the,O
45,one,O
46,to,O
47,French,O
48,presidential,O
49,candidate,O
50,Emmanuel,O
51,Macron,O
52,’,O
53,s,O
54,campaign,O
55,.,O
56,Incident,O
57,response,O
58,to,O
59,this,O
60,Advanced,O
61,Persistent,O
62,Threats,O
63,(,O
64,APT,O
65,),O
66,and,O
67,damage,O
68,limitation,O
69,heavily,O
70,relies,O
71,on,O
72,network,O
73,traffic,O
74,investigation,O
75,.,O
76,In,O
77,late,O
78,2016,O
79,",",O
80,Redsocks,O
81,security,O
82,identified,O
83,one,O
84,expired,O
85,domain,O
86,attributed,O
87,to,O
88,APT28,B-Actor
89,.,O
90,Our,O
91,effort,O
92,to,O
93,sinkhole,O
94,APT28,B-Actor
95,based,O
96,on,O
97,using,O
98,this,O
99,domain,O
100,was,O
101,impeded,O
102,by,O
103,the,O
104,encrypted,O
105,communication,O
106,channel,O
107,.,O
108,Although,O
109,many,O
110,published,O
111,white,O
112,papers,O
113,concerning,O
114,APT28,B-Actor
115,such,O
116,as,O
117,ESET,O
118,mentions,O
119,RC4,O
120,encryption,O
121,algorithm,O
122,",",O
123,they,O
124,do,O
125,not,O
126,dig,O
127,into,O
128,the,O
129,details,O
130,of,O
131,the,O
132,used,O
133,key,O
134,and,O
135,the,O
136,details,O
137,of,O
138,APT28,B-Actor
139,implementation,O
140,of,O
141,RC4,O
142,;,O
143,whether,O
144,the,O
145,key,O
146,is,O
147,static,O
148,and,O
149,breakable,O
150,.,O
151,In,O
152,this,O
153,report,O
154,",",O
155,we,O
156,aim,O
157,to,O
158,reveal,O
159,the,O
160,result,O
161,of,O
162,our,O
163,comprehensive,O
164,dynamic,O
165,analysis,O
166,of,O
167,x,O
168,-,O
169,agent,O
170,malware,O
171,towards,O
172,decrypting,O
173,its,O
174,traffic,O
175,.,O
176,We,O
177,started,O
178,our,O
179,investigation,O
180,by,O
181,using,O
182,one,O
183,of,O
184,the,O
185,APT28,B-Actor
186,droppers,O
187,(,O
188,see,O
189,Table,O
190,1,O
191,).,O
192,The,O
193,focus,O
194,of,O
195,our,O
196,investigation,O
197,has,O
198,been,O
199,decrypting,O
200,APT28,B-Actor
201,communicated,O
202,traffic,O
203,.,O
204,Thus,O
205,",",O
206,this,O
207,report,O
208,elaborates,O
209,more,O
210,on,O
211,encryption,O
212,functionality,O
213,of,O
214,x,O
215,-,O
216,agent,O
217,and,O
218,reports,O
219,our,O
220,finding,O
221,on,O
222,cracking,O
223,x,O
224,-,O
225,agent,O
226,communicated,O
227,traffic,O
228,.,O
229,That,O
230,said,O
231,",",O
232,our,O
233,report,O
234,is,O
235,not,O
236,limited,O
237,to,O
238,encryption,O
239,cracking,O
240,and,O
241,sheds,O
242,light,O
243,on,O
244,following,O
245,:,O
246,Execution,O
247,behavior,O
248,of,O
249,the,O
250,dropper,O
251,and,O
252,x,O
253,-,O
254,agent,O
255,Network,O
256,behavior,O
257,of,O
258,x,O
259,-,O
260,agent,O
261,Encryption,O
262,of,O
263,APT28,B-Actor
264,and,O
265,an,O
266,algorithm,O
267,to,O
268,crack,O
269,it,O
270,in,O
271,few,O
272,seconds,O
273,Following,O
274,the,O
275,encryption,O
276,-,O
277,decryption,O
278,scheme,O
279,we,O
280,present,O
281,",",O
282,and,O
283,by,O
284,vast,O
285,internet,O
286,scanning,O
287,and,O
288,searching,O
289,for,O
290,the,O
291,URL,O
292,pattern,O
293,we,O
294,introduce,O
295,in,O
296,this,O
297,white,O
298,paper,O
299,",",O
300,current,O
301,active,O
302,APT28,B-Actor
303,servers,O
304,and,O
305,victims,O
306,can,O
307,be,O
308,found,O
309,.,O
310,Communication,O
311,to,O
312,these,O
313,servers,O
314,for,O
315,further,O
316,investigation,O
317,can,O
318,be,O
319,established,O
320,.,O
321,The,O
322,dropper,O
323,functions,O
324,in,O
325,two,O
326,steps,O
327,.,O
328,In,O
329,the,O
330,first,O
331,step,O
332,",",O
333,it,O
334,only,O
335,unpacks,O
336,a,O
337,dll,O
338,to,O
339,the,O
340,Windows,O
341,folder,O
342,.,O
343,The,O
344,name,O
345,of,O
346,the,O
347,file,O
348,is,O
349,fixed,O
350,(,O
351,static,O
352,),O
353,and,O
354,it,O
355,does,O
356,not,O
357,change,O
358,by,O
359,multiple,O
360,executions,O
361,or,O
362,on,O
363,different,O
364,workstations,O
365,.,O
366,In,O
367,the,O
368,second,O
369,step,O
370,",",O
371,the,O
372,dropper,O
373,loads,O
374,the,O
375,dll,O
376,by,O
377,calling,O
378,ShellExecuteW,O
379,function,O
380,of,O
381,shell32,O
382,library,O
383,.,O
384,This,O
385,function,O
386,is,O
387,called,O
388,by,O
389,rundll32,O
390,.,O
391,exe,O
392,",",O
393,and,O
394,“”,O
395,C,O
396,:\,O
397,Windows,O
398,\,O
399,83D2CDE2,O
400,-,O
401,8311,O
402,-,O
403,40CB,O
404,-,O
405,B51D,O
406,-,O
407,EBE20FA803D1,O
408,.,O
409,dll,O
410,"”,",O
411,init,O
412,”,O
413,as,O
414,arguments,O
415,.,O
416,This,O
417,means,O
418,the,O
419,trace,O
420,of,O
421,the,O
422,malware,O
423,",",O
424,later,O
425,",",O
426,should,O
427,be,O
428,looked,O
429,in,O
430,rundll32,O
431,execution,O
432,.,O
433,The,O
434,dropper,O
435,also,O
436,creates,O
437,“,O
438,ose00000,O
439,.,O
440,exe,O
441,”,O
442,file,O
443,in,O
444,the,O
445,windows,O
446,folder,O
447,and,O
448,calls,O
449,it,O
450,with,O
451,arguments,O
452,to,O
453,the,O
454,dll,O
455,and,O
456,the,O
457,dropper,O
458,path,O
459,address,O
460,.,O
461,In,O
462,summary,O
463,",",O
464,the,O
465,dropper,O
466,creates,O
467,two,O
468,files,O
469,“,O
470,83D2CDE2,O
471,-,O
472,8311,O
473,-,O
474,40CB,O
475,-,O
476,B51D,O
477,-,O
478,EBE20FA803D1,O
479,.,O
480,dll,O
481,”,O
482,and,O
483,“,O
484,ose00000,O
485,.,O
486,exe,O
487,”,O
488,in,O
489,windows,O
490,directory,O
491,with,O
492,hidden,O
493,attribute,O
494,(,O
495,see,O
496,Table,O
497,1,O
498,for,O
499,the,O
500,corresponding,O
501,hashes,O
502,),O
503,and,O
504,loads,O
505,one,O
506,with,O
507,rundll32,O
508,.,O
509,exe,O
510,.,O
511,The,O
512,result,O
513,of,O
514,the,O
515,dropper,O
516,execution,O
517,is,O
518,rundll32,O
519,.,O
520,exe,O
521,and,O
522,ose00000,O
523,.,O
524,exe,O
525,as,O
526,two,O
527,separate,O
528,processes,O
529,.,O
530,No,O
531,network,O
532,activity,O
533,was,O
534,observed,O
535,during,O
536,dropper,O
537,execution,O
538,.,O
539,X,O
540,-,O
541,agent,O
542,dropped,O
543,rootkit,O
544,The,O
545,dropper,O
546,goal,O
547,was,O
548,to,O
549,transfer,O
550,control,O
551,to,O
552,83D2CDE2,O
553,-,O
554,8311,O
555,-,O
556,40CB,O
557,-,O
558,B51D,O
559,-,O
560,EBE20FA803D1,O
561,.,O
562,dll,O
563,(,O
564,see,O
565,Table,O
566,1,O
567,for,O
568,SHA256,O
569,hash,O
570,),O
571,which,O
572,is,O
573,a,O
574,rootkit,O
575,with,O
576,keylogging,O
577,and,O
578,remote,O
579,code,O
580,execution,O
581,capabilities,O
582,.,O
583,X,O
584,-,O
585,agent,O
586,architecture,O
587,x,O
588,-,O
589,agent,O
590,has,O
591,a,O
592,sophisticated,O
593,architecture,O
594,;,O
595,it,O
596,has,O
597,a,O
598,modular,O
599,structure,O
600,in,O
601,both,O
602,functionalities,O
603,and,O
604,the,O
605,communication,O
606,channel,O
607,implementation,O
608,.,O
609,Figure,O
610,1,O
611,presents,O
612,the,O
613,x,O
614,-,O
615,agent,O
616,architecture,O
617,of,O
618,the,O
619,sample,O
620,we,O
621,analyzed,O
622,.,O
623,X,O
624,-,O
625,agent,O
626,execution,O
627,The,O
628,execution,O
629,starts,O
630,from,O
631,init,O
632,function,O
633,of,O
634,the,O
635,loaded,O
636,dll,O
637,by,O
638,rundll32,O
639,.,O
640,The,O
641,first,O
642,interesting,O
643,event,O
644,after,O
645,transferring,O
646,control,O
647,to,O
648,Init,O
649,is,O
650,a,O
651,call,O
652,to,O
653,KERNEL32,O
654,.,O
655,GetVolumeInformationW,O
656,.,O
657,After,O
658,this,O
659,call,O
660,",",O
661,the,O
662,Init,O
663,function,O
664,initializes,O
665,the,O
666,global,O
667,variables,O
668,:,O
669,Next,O
670,",",O
671,the,O
672,init,O
673,function,O
674,initializes,O
675,the,O
676,available,O
677,modules,O
678,for,O
679,execution,O
680,(,O
681,see,O
682,ESET,O
683,report,O
684,on,O
685,the,O
686,explanation,O
687,of,O
688,modules,O
689,).,O
690,Our,O
691,malware,O
692,sample,O
693,had,O
694,3,O
695,modules,O
696,:,O
697,KeyLogging,O
698,modules,O
699,",",O
700,dubbed,O
701,in,O
702,code,O
703,as,O
704,modKey,O
705,File,O
706,system,O
707,module,O
708,",",O
709,dubbed,O
710,in,O
711,code,O
712,as,O
713,modFS,O
714,Remote,O
715,Shell,O
716,module,O
717,",",O
718,dubbed,O
719,in,O
720,code,O
721,as,O
722,modProcRet,O
723,After,O
724,initializing,O
725,the,O
726,data,O
727,structure,O
728,of,O
729,these,O
730,modules,O
731,",",O
732,CHOPSTICK,B-Malware
733,creates,O
734,different,O
735,threads,O
736,for,O
737,different,O
738,tasks,O
739,.,O
740,Modules,O
741,are,O
742,created,O
743,in,O
744,a,O
745,loop,O
746,based,O
747,on,O
748,their,O
749,configuration,O
750,and,O
751,AgentKernel,O
752,is,O
753,created,O
754,differently,O
755,:,O
756,After,O
757,creation,O
758,of,O
759,the,O
760,threads,O
761,",",O
762,execution,O
763,is,O
764,transferred,O
765,to,O
766,AgentKernel,O
767,and,O
768,Module,O
769,threads,O
770,.,O
771,Agent,O
772,Kernel,O
773,module,O
774,initially,O
775,prepares,O
776,a,O
777,message,O
778,for,O
779,the,O
780,server,O
781,and,O
782,then,O
783,waits,O
784,for,O
785,the,O
786,server,O
787,to,O
788,respond,O
789,with,O
790,a,O
791,command,O
792,.,O
793,The,O
794,message,O
795,intends,O
796,to,O
797,introduce,O
798,the,O
799,victim,O
800,by,O
801,an,O
802,agent,O
803,ID,O
804,to,O
805,the,O
806,server,O
807,and,O
808,report,O
809,the,O
810,supported,O
811,modules,O
812,for,O
813,execution,O
814,.,O
815,This,O
816,message,O
817,is,O
818,written,O
819,to,O
820,edg6EF885E2,O
821,.,O
822,tmp,O
823,file,O
824,in,O
825,the,O
826,temp,O
827,folder,O
828,.,O
829,The,O
830,sample,O
831,we,O
832,analyzed,O
833,communicates,O
834,over,O
835,HTTP,O
836,channel,O
837,.,O
838,The,O
839,implementation,O
840,is,O
841,using,O
842,WININET,O
843,APIs,O
844,.,O
845,Before,O
846,sending,O
847,data,O
848,",",O
849,the,O
850,channel,O
851,thread,O
852,checks,O
853,the,O
854,connectivity,O
855,to,O
856,the,O
857,server,O
858,.,O
859,It,O
860,",",O
861,first,O
862,",",O
863,tries,O
864,to,O
865,resolve,O
866,“,O
867,adobeincorp,O
868,.,O
869,com,O
870,”,O
871,domain,O
872,name,O
873,.,O
874,If,O
875,it,O
876,fails,O
877,",",O
878,it,O
879,tries,O
880,connecting,O
881,to,O
882,two,O
883,hardcoded,O
884,IP,O
885,addresses,O
886,.,O
887,After,O
888,successful,O
889,connection,O
890,to,O
891,the,O
892,server,O
893,",",O
894,it,O
895,creates,O
896,the,O
897,URL,O
898,request,O
899,and,O
900,post,O
901,data,O
902,based,O
903,on,O
904,the,O
905,data,O
906,prepared,O
907,by,O
908,other,O
909,modules,O
910,.,O
911,X,O
912,-,O
913,agent,O
914,first,O
915,sends,O
916,a,O
917,get,O
918,request,O
919,and,O
920,then,O
921,a,O
922,post,O
923,request,O
924,.,O
925,The,O
926,communication,O
927,is,O
928,always,O
929,encrypted,O
930,.,O
931,We,O
932,explain,O
933,the,O
934,nature,O
935,of,O
936,communicated,O
937,data,O
938,and,O
939,the,O
940,encryption,O
941,method,O
942,in,O
943,the,O
944,next,O
945,section,O
946,.,O
947,In,O
948,summary,O
949,",",O
950,these,O
951,sequences,O
952,of,O
953,actions,O
954,happen,O
955,in,O
956,every,O
957,execution,O
958,of,O
959,x,O
960,-,O
961,agent,O
962,:,O
963,Call,O
964,to,O
965,KERNEL32,O
966,.,O
967,GetVolumeInformationW,O
968,Creation,O
969,of,O
970,at,O
971,least,O
972,5,O
973,different,O
974,threads,O
975,Read,O
976,and,O
977,write,O
978,to,O
979,edg6EF885E2,O
980,.,O
981,tmp,O
982,in,O
983,the,O
984,temp,O
985,directory,O
986,Check,O
987,connectivity,O
988,by,O
989,call,O
990,to,O
991,socket,O
992,.,O
993,connect,O
994,Encrypt,O
995,URL,O
996,query,O
997,string,O
998,and,O
999,POST,O
1000,data,O
1001,Sends,O
1002,a,O
1003,get,O
1004,request,O
1005,Sends,O
1006,a,O
1007,post,O
1008,request,O
1009,Send,O
1010,supported,O
1011,commands,O
1012,and,O
1013,the,O
1014,agent,O
1015,number,O
1016,to,O
1017,server,O
1018,using,O
1019,WININET,O
1020,Http,O
1021,APIs,O
1022,.,O
1023,X,O
1024,-,O
1025,agent,O
1026,traffic,O
1027,communication,O
1028,In,O
1029,order,O
1030,to,O
1031,explain,O
1032,how,O
1033,to,O
1034,decrypt,O
1035,APT28,B-Actor
1036,traffic,O
1037,",",O
1038,we,O
1039,first,O
1040,need,O
1041,to,O
1042,understand,O
1043,the,O
1044,traffic,O
1045,pattern,O
1046,of,O
1047,the,O
1048,malware,O
1049,.,O
1050,The,O
1051,x,O
1052,-,O
1053,agent,O
1054,version,O
1055,1,O
1056,we,O
1057,analyzed,O
1058,communicates,O
1059,by,O
1060,sending,O
1061,an,O
1062,initial,O
1063,GET,O
1064,request,O
1065,following,O
1066,by,O
1067,HTTP,O
1068,post,O
1069,requests,O
1070,.,O
1071,The,O
1072,http,O
1073,header,O
1074,values,O
1075,of,O
1076,the,O
1077,requests,O
1078,are,O
1079,hardcoded,O
1080,except,O
1081,one,O
1082,query,O
1083,string,O
1084,of,O
1085,the,O
1086,request,O
1087,.,O
1088,The,O
1089,URL,O
1090,of,O
1091,a,O
1092,x,O
1093,-,O
1094,agent,O
1095,traffic,O
1096,looks,O
1097,like,O
1098,:,O
1099,/,O
1100,webhp,O
1101,?,O
1102,rel,O
1103,=,O
1104,psy,O
1105,&,O
1106,hl,O
1107,=,O
1108,7,O
1109,&,O
1110,ai,O
1111,=,O
1112,L2Bd93t_o,O
1113,-,O
1114,jl022K1Og4Bm9mSk8QO88K_3ZQZuKcoPwur,O
1115,-,O
1116,5Q7Y,O
1117,=,O
1118,“/,O
1119,webhp,O
1120,?,O
1121,rel,O
1122,=,O
1123,psy,O
1124,&,O
1125,hl,O
1126,=,O
1127,7,O
1128,&,O
1129,ai,O
1130,=”,O
1131,part,O
1132,of,O
1133,the,O
1134,URL,O
1135,and,O
1136,the,O
1137,final,O
1138,“=,O
1139,“,O
1140,sign,O
1141,are,O
1142,persistent,O
1143,in,O
1144,different,O
1145,executions,O
1146,.,O
1147,As,O
1148,a,O
1149,matter,O
1150,of,O
1151,fact,O
1152,",",O
1153,“/,O
1154,webhp,O
1155,?,O
1156,rel,O
1157,=,O
1158,psy,O
1159,&,O
1160,hl,O
1161,=,O
1162,7,O
1163,&,O
1164,ai,O
1165,=”,O
1166,is,O
1167,hardcoded,O
1168,in,O
1169,the,O
1170,code,O
1171,.,O
1172,The,O
1173,next,O
1174,51,O
1175,bytes,O
1176,are,O
1177,not,O
1178,in,O
1179,plaintext,O
1180,;,O
1181,briefly,O
1182,",",O
1183,it,O
1184,contains,O
1185,the,O
1186,timestamp,O
1187,of,O
1188,the,O
1189,request,O
1190,and,O
1191,the,O
1192,ID,O
1193,of,O
1194,the,O
1195,agent,O
1196,.,O
1197,The,O
1198,initial,O
1199,POST,O
1200,data,O
1201,of,O
1202,x,O
1203,-,O
1204,agent,O
1205,is,O
1206,71,O
1207,bytes,O
1208,and,O
1209,ends,O
1210,with,O
1211,a,O
1212,=,O
1213,as,O
1214,well,O
1215,.,O
1216,The,O
1217,data,O
1218,is,O
1219,encrypted,O
1220,and,O
1221,when,O
1222,decrypted,O
1223,is,O
1224,equal,O
1225,to,O
1226,:,O
1227,56,O
1228,34,O
1229,4D,O
1230,47,O
1231,|,O
1232,4E,O
1233,78,O
1234,5A,O
1235,57,O
1236,|,O
1237,6C,O
1238,76,O
1239,63,O
1240,6D,O
1241,|,O
1242,68,O
1243,6A,O
1244,4F,O
1245,47,O
1246,|,O
1247,39,O
1248,79,O
1249,5A,O
1250,51,O
1251,|,O
1252,6B,O
1253,30,O
1254,84,O
1255,F2,O
1256,|,O
1257,01,O
1258,00,O
1259,00,O
1260,01,O
1261,|,O
1262,00,O
1263,23,O
1264,01,O
1265,10,O
1266,|,O
1267,23,O
1268,01,O
1269,11,O
1270,23,O
1271,|,O
1272,01,O
1273,13,O
1274,23,O
1275,The,O
1276,blue,O
1277,part,O
1278,is,O
1279,the,O
1280,ID,O
1281,of,O
1282,the,O
1283,agent,O
1284,(,O
1285,the,O
1286,victim,O
1287,).,O
1288,The,O
1289,yellow,O
1290,part,O
1291,is,O
1292,the,O
1293,ID,O
1294,of,O
1295,the,O
1296,module,O
1297,who,O
1298,sent,O
1299,the,O
1300,data,O
1301,.,O
1302,And,O
1303,finally,O
1304,",",O
1305,the,O
1306,green,O
1307,part,O
1308,is,O
1309,actually,O
1310,the,O
1311,list,O
1312,of,O
1313,modules,O
1314,separated,O
1315,by,O
1316,#,O
1317,character,O
1318,(,O
1319,0x23,O
1320,),O
1321,that,O
1322,are,O
1323,installed,O
1324,and,O
1325,ready,O
1326,to,O
1327,be,O
1328,used,O
1329,by,O
1330,the,O
1331,server,O
1332,(,O
1333,see,O
1334,Figure,O
1335,4,O
1336,for,O
1337,more,O
1338,explanation,O
1339,).,O
1340,Below,O
1341,is,O
1342,the,O
1343,Http,O
1344,implementation,O
1345,of,O
1346,the,O
1347,channel,O
1348,by,O
1349,x,O
1350,-,O
1351,agent,O
1352,:,O
1353,X,O
1354,-,O
1355,agent,O
1356,traffic,O
1357,encryption,O
1358,Encryption,O
1359,module,O
1360,The,O
1361,encryption,O
1362,procedure,O
1363,is,O
1364,called,O
1365,with,O
1366,two,O
1367,arguments,O
1368,.,O
1369,The,O
1370,pointers,O
1371,are,O
1372,to,O
1373,two,O
1374,data,O
1375,structures,O
1376,.,O
1377,These,O
1378,data,O
1379,structures,O
1380,provide,O
1381,a,O
1382,reference,O
1383,to,O
1384,the,O
1385,two,O
1386,following,O
1387,data,O
1388,for,O
1389,the,O
1390,encryption,O
1391,class,O
1392,:,O
1393,The,O
1394,seed,O
1395,for,O
1396,encryption,O
1397,The,O
1398,data,O
1399,to,O
1400,be,O
1401,encrypted,O
1402,The,O
1403,seed,O
1404,is,O
1405,hardcoded,O
1406,and,O
1407,",",O
1408,among,O
1409,others,O
1410,",",O
1411,the,O
1412,init,O
1413,function,O
1414,copies,O
1415,it,O
1416,to,O
1417,the,O
1418,data,O
1419,segment,O
1420,using,O
1421,immediate,O
1422,constants,O
1423,:,O
1424,Later,O
1425,",",O
1426,in,O
1427,the,O
1428,code,O
1429,",",O
1430,4,O
1431,random,O
1432,bytes,O
1433,are,O
1434,appended,O
1435,to,O
1436,the,O
1437,seed,O
1438,and,O
1439,these,O
1440,altogether,O
1441,form,O
1442,the,O
1443,key,O
1444,for,O
1445,encryption,O
1446,.,O
1447,The,O
1448,seed,O
1449,is,O
1450,50,O
1451,bytes,O
1452,and,O
1453,the,O
1454,key,O
1455,length,O
1456,in,O
1457,total,O
1458,is,O
1459,54,O
1460,bytes,O
1461,.,O
1462,The,O
1463,data,O
1464,can,O
1465,be,O
1466,of,O
1467,variable,O
1468,size,O
1469,.,O
1470,For,O
1471,instance,O
1472,",",O
1473,the,O
1474,default,O
1475,initial,O
1476,request,O
1477,from,O
1478,AgentKernel,O
1479,is,O
1480,39,O
1481,bytes,O
1482,(,O
1483,see,O
1484,Figure,O
1485,4,O
1486,),O
1487,in,O
1488,total,O
1489,and,O
1490,includes,O
1491,:,O
1492,agent,O
1493,ID,O
1494,",",O
1495,module,O
1496,ID,O
1497,(,O
1498,the,O
1499,sender,O
1500,of,O
1501,the,O
1502,message,O
1503,),O
1504,and,O
1505,the,O
1506,supported,O
1507,modules,O
1508,.,O
1509,The,O
1510,data,O
1511,is,O
1512,always,O
1513,appended,O
1514,to,O
1515,a,O
1516,20,O
1517,bytes,O
1518,data,O
1519,token,O
1520,",",O
1521,agent,O
1522,ID,O
1523,and,O
1524,the,O
1525,sender,O
1526,module,O
1527,ID,O
1528,.,O
1529,This,O
1530,data,O
1531,token,O
1532,is,O
1533,used,O
1534,for,O
1535,decryption,O
1536,result,O
1537,verification,O
1538,by,O
1539,the,O
1540,server,O
1541,.,O
1542,After,O
1543,creating,O
1544,the,O
1545,cypher,O
1546,using,O
1547,RC4,O
1548,(,O
1549,see,O
1550,the,O
1551,next,O
1552,section,O
1553,"),",O
1554,the,O
1555,encryption,O
1556,procedure,O
1557,adds,O
1558,a,O
1559,8,O
1560,random,O
1561,value,O
1562,to,O
1563,the,O
1564,message,O
1565,and,O
1566,then,O
1567,converts,O
1568,the,O
1569,whole,O
1570,binary,O
1571,string,O
1572,to,O
1573,URL,O
1574,compatible,O
1575,BASE64,O
1576,.,O
1577,.,O
1578,Next,O
1579,",",O
1580,the,O
1581,encryption,O
1582,procedure,O
1583,adds,O
1584,a,O
1585,7,O
1586,-,O
1587,byte,O
1588,time,O
1589,stamp,O
1590,to,O
1591,the,O
1592,message,O
1593,.,O
1594,In,O
1595,summary,O
1596,the,O
1597,encryption,O
1598,class,O
1599,does,O
1600,the,O
1601,following,O
1602,:,O
1603,Generate,O
1604,random,O
1605,4,O
1606,bytes,O
1607,Encrypt,O
1608,the,O
1609,message,O
1610,using,O
1611,RC4,O
1612,Add,O
1613,8,O
1614,random,O
1615,bytes,O
1616,to,O
1617,the,O
1618,message,O
1619,Convert,O
1620,the,O
1621,binary,O
1622,string,O
1623,to,O
1624,BASE64,O
1625,Add,O
1626,a,O
1627,timestamp,O
1628,to,O
1629,the,O
1630,message,O
1631,(,O
1632,7,O
1633,bytes,O
1634,in,O
1635,BASE64,O
1636,),O
1637,RC4,O
1638,function,O
1639,RC4,O
1640,is,O
1641,a,O
1642,stream,O
1643,cypher,O
1644,algorithm,O
1645,and,O
1646,is,O
1647,based,O
1648,on,O
1649,byte,O
1650,permutation,O
1651,.,O
1652,The,O
1653,elaborate,O
1654,explanation,O
1655,of,O
1656,RC4,O
1657,is,O
1658,out,O
1659,of,O
1660,the,O
1661,scope,O
1662,of,O
1663,this,O
1664,paper,O
1665,.,O
1666,The,O
1667,below,O
1668,code,O
1669,is,O
1670,the,O
1671,implementation,O
1672,of,O
1673,RC4,O
1674,algorithm,O
1675,by,O
1676,x,O
1677,-,O
1678,agent,O
1679,.,O
1680,The,O
1681,arguments,O
1682,to,O
1683,the,O
1684,function,O
1685,are,O
1686,4,O
1687,bytes,O
1688,random,O
1689,value,O
1690,",",O
1691,seed,O
1692,and,O
1693,the,O
1694,plaintext,O
1695,data,O
1696,:,O
1697,CPU,O
1698,Disasm,O
1699,How,O
1700,to,O
1701,decrypt,O
1702,x,O
1703,-,O
1704,agent,O
1705,data,O
1706,As,O
1707,mentioned,O
1708,briefly,O
1709,",",O
1710,the,O
1711,only,O
1712,randomness,O
1713,in,O
1714,the,O
1715,x,O
1716,-,O
1717,agent,O
1718,encryption,O
1719,is,O
1720,a,O
1721,4,O
1722,random,O
1723,bytes,O
1724,appended,O
1725,to,O
1726,a,O
1727,50,O
1728,bytes,O
1729,seed,O
1730,that,O
1731,has,O
1732,been,O
1733,given,O
1734,in,O
1735,the,O
1736,previous,O
1737,section,O
1738,.,O
1739,Since,O
1740,RC4,O
1741,is,O
1742,a,O
1743,synchronous,O
1744,stream,O
1745,cypher,O
1746,",",O
1747,one,O
1748,can,O
1749,decrypt,O
1750,the,O
1751,traffic,O
1752,only,O
1753,with,O
1754,the,O
1755,same,O
1756,key,O
1757,that,O
1758,is,O
1759,used,O
1760,for,O
1761,encryption,O
1762,.,O
1763,A,O
1764,decryption,O
1765,algorithm,O
1766,for,O
1767,x,O
1768,-,O
1769,agent,O
1770,must,O
1771,use,O
1772,the,O
1773,same,O
1774,RC4,O
1775,function,O
1776,for,O
1777,decryption,O
1778,with,O
1779,the,O
1780,same,O
1781,arguments,O
1782,.,O
1783,The,O
1784,cypher,O
1785,input,O
1786,must,O
1787,be,O
1788,the,O
1789,same,O
1790,data,O
1791,byte,O
1792,stream,O
1793,from,O
1794,the,O
1795,http,O
1796,request,O
1797,i,O
1798,.,O
1799,e,O
1800,.,O
1801,the,O
1802,timestamp,O
1803,and,O
1804,random,O
1805,bytes,O
1806,must,O
1807,be,O
1808,stripped,O
1809,.,O
1810,The,O
1811,RC4,O
1812,function,O
1813,must,O
1814,be,O
1815,called,O
1816,in,O
1817,a,O
1818,bruteforced,O
1819,way,O
1820,with,O
1821,all,O
1822,possible,O
1823,values,O
1824,from,O
1825,0,O
1826,to,O
1827,-,O
1828,1,O
1829,.,O
1830,This,O
1831,is,O
1832,a,O
1833,known,O
1834,plain,O
1835,-,O
1836,text,O
1837,attack,O
1838,since,O
1839,the,O
1840,result,O
1841,must,O
1842,contain,O
1843,“,O
1844,V4MGNxZWlvcmhjOG9yZQ,O
1845,”.,O
1846,The,O
1847,encryption,O
1848,must,O
1849,be,O
1850,broken,O
1851,in,O
1852,a,O
1853,matter,O
1854,of,O
1855,seconds,O
1856,with,O
1857,a,O
1858,normal,O
1859,personal,O
1860,computer,O
1861,.,O
1862,About,O
1863,the,O
1864,Author,O
1865,REDSOCKS,O
1866,By,O
1867,Sina,O
1868,Davanian,O
1869,RedSocks,O
1870,is,O
1871,a,O
1872,Dutch,O
1873,company,O
1874,specialised,O
1875,in,O
1876,malware,O
1877,detection,O
1878,.,O
1879,RedSocks,O
1880,supplies,O
1881,RedSocks,O
1882,malware,O
1883,threat,O
1884,defender,O
1885,as,O
1886,a,O
1887,network,O
1888,appliance,O
1889,.,O
1890,This,O
1891,innovative,O
1892,appliance,O
1893,analyses,O
1894,digital,O
1895,traffic,O
1896,flows,O
1897,in,O
1898,real,O
1899,time,O
1900,based,O
1901,on,O
1902,the,O
1903,algorithms,O
1904,and,O
1905,lists,O
1906,of,O
1907,malicious,O
1908,indicators,O
1909,compiled,O
1910,by,O
1911,the,O
1912,RedSocks,O
1913,Malware,O
1914,Intelligence,O
1915,Team,O
1916,.,O
1917,This,O
1918,team,O
1919,consists,O
1920,of,O
1921,specialists,O
1922,in,O
1923,identifying,O
1924,new,O
1925,threats,O
1926,on,O
1927,the,O
1928,internet,O
1929,and,O
1930,translating,O
1931,them,O
1932,into,O
1933,state,O
1934,-,O
1935,of,O
1936,-,O
1937,the,O
1938,-,O
1939,art,O
1940,malware,O
1941,detection,O
1942,.,O
1943,Pierluigi,O
1944,Paganini,O
1945,(,O
1946,Security,O
1947,Affairs,O
1948,–,O
1949,APT28,B-Actor
1950,",",O
1951,state,O
1952,-,O
1953,sponsored,O
1954,hacking,O
1955,),O
1956,Share,O
1957,On,O
